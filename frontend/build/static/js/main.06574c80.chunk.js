(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{101:function(e,t,n){},105:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),s=n(17),c=n.n(s),l=(n(65),n(4)),o=n.n(l),u=n(8),i=n(21),p=n(22),m=n(24),d=n(23),h=n(25),f=n(15),v=n(18),g=n(50),b=n(26),E=function(e){var t=e.onValueChange,n=e.value,r=e.onButtonClick,s=e.error;return a.a.createElement("form",{className:"form row",onSubmit:r},a.a.createElement("div",{className:"col-md-8 align-self-center"},a.a.createElement("input",{className:"input",type:"text",onChange:t,value:n,placeholder:"Shorten Your Link"}),s&&a.a.createElement("div",{className:"alert alert-danger"},s)),a.a.createElement("div",{className:"col-md-4"},a.a.createElement("div",{className:"confirm"},a.a.createElement("button",{className:"button",onClick:r},"Shorten"))))},S=n(19),k=n.n(S);k.a.interceptors.response.use(null,(function(e){return e.response&&e.response.status>=400&&e.response.status<500||(console.log("Unexpected error occurs",e),alert("An unexpected error occured")),Promise.reject(e)}));var O={get:k.a.get,post:k.a.post,put:k.a.put,delete:k.a.delete,setJwt:function(e){k.a.defaults.headers.common["x-auth-token"]=e}},U={shortenUrl:function(){var e=Object(u.a)(o.a.mark((function e(t){var n,r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O.post("http://api.urls.banvuong.com/api/url",{longUrl:t});case 2:return n=e.sent,r=n.data,e.abrupt("return",r);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},w="http://api.urls.banvuong.com/api/user",y={getUserInfo:function(){var e=Object(u.a)(o.a.mark((function e(){var t,n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O.get(w);case 2:return t=e.sent,n=t.data,e.abrupt("return",n);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),postUrls:function(){var e=Object(u.a)(o.a.mark((function e(t){var n,r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O.post(w,{urls:t});case 2:return n=e.sent,r=n.data,e.abrupt("return",r);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),deleteUrls:function(){var e=Object(u.a)(o.a.mark((function e(t){var n,r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O.delete(w,{data:{urls:t}});case 2:return n=e.sent,r=n.data,e.abrupt("return",r);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},j=function(e){var t=function(e){return e.save?"fa fa-heart hover":"fa fa-heart-o hover"},n=e.urls,r=e.onHearClick,s=e.user;return a.a.createElement("div",{className:"shorten-action"},a.a.createElement("ul",{className:"item-list"},n.length?n.map((function(e,n){return a.a.createElement("div",{className:"item"},a.a.createElement("li",{className:"row"},a.a.createElement("div",{className:"long-link col-md-7"},e.longUrl),a.a.createElement("div",{className:"col-md-3"},a.a.createElement("a",{href:e.shortUrl},e.shortUrl)),s?a.a.createElement("div",{className:"col-md-2"},a.a.createElement("i",{className:t(e),"aria-hidden":"true",onClick:function(){return r(n)}})):null))})):null))};function C(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}window.onbeforeunload=function(){return localStorage.removeItem("mainpage")};var N=function(e){function t(){var e,n;Object(i.a)(this,t);for(var r=arguments.length,a=new Array(r),s=0;s<r;s++)a[s]=arguments[s];return(n=Object(m.a)(this,(e=Object(d.a)(t)).call.apply(e,[this].concat(a)))).state={longUrl:"",urls:[],saveUrls:[],error:null},n.mapToViewModel=function(e){return{id:e._id,longUrl:e.longUrl,shortUrl:e.shortUrl,save:!1}},n.handleShortenClicked=function(){var e=Object(u.a)(o.a.mark((function e(t){var r,a,s,c;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),r=n.state.longUrl,a=JSON.parse(JSON.stringify(n.state.urls)),e.prev=3,e.next=6,U.shortenUrl(r);case 6:s=e.sent,c=n.mapToViewModel(s),a.push(c),n.setState({urls:a,longUrl:"",error:null}),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(3),e.t0.response&&400===e.t0.response.status&&n.setState({error:e.t0.response.data});case 15:case"end":return e.stop()}}),e,null,[[3,12]])})));return function(t){return e.apply(this,arguments)}}(),n.handleValueChanged=function(e){var t=e.target.value;n.setState({longUrl:t})},n.handleHeartClicked=function(e){var t=Object(b.a)(n.state.saveUrls),r=JSON.parse(JSON.stringify(n.state.urls)),a=r[e];a.save?(a.save=!1,t=t.filter((function(e){return e!==a.id}))):(a.save=!0,t.push(a.id)),n.setState({urls:r,saveUrls:t})},n.handleSaveClicked=function(){var e=Object(u.a)(o.a.mark((function e(t){var r,a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((r=n.state.saveUrls).length){e.next=3;break}return e.abrupt("return",v.a.info("Heart the URL to Save"));case 3:return e.prev=3,e.next=6,y.postUrls(r);case 6:e.sent,a=(a=JSON.parse(JSON.stringify(n.state.urls))).filter((function(e){return!1===e.save})),n.setState({urls:a,saveUrls:[]},(function(){return v.a.success("Saved")})),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(3),e.t0.response&&400===e.t0.response.status&&n.setState({error:e.t0.response.data});case 15:case"end":return e.stop()}}),e,null,[[3,12]])})));return function(t){return e.apply(this,arguments)}}(),n}return Object(h.a)(t,e),Object(p.a)(t,[{key:"componentDidMount",value:function(){var e=localStorage.getItem("mainpage");e&&(e=JSON.parse(e),this.setState(e))}},{key:"componentWillUnmount",value:function(){var e=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?C(n,!0).forEach((function(t){Object(g.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):C(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},this.state);e=JSON.stringify(e),localStorage.setItem("mainpage",e)}},{key:"render",value:function(){var e=this.state,t=e.longUrl,n=e.urls,r=(e.saveUrls,e.error),s=this.props.user;return a.a.createElement(a.a.Fragment,null,a.a.createElement("div",{className:"banner"},a.a.createElement("h1",{className:"title"},"SHORTEN URL")),a.a.createElement("section",{className:"shorten-app"},a.a.createElement("div",{className:"container"},a.a.createElement(E,{onValueChange:this.handleValueChanged,value:t,onButtonClick:this.handleShortenClicked,error:r}),a.a.createElement(j,{urls:n,onHearClick:this.handleHeartClicked,user:s}),s&&a.a.createElement("div",{className:"confirm"},a.a.createElement("button",{className:"button",onClick:this.handleSaveClicked},"Save")))))}}]),t}(r.Component),x=n(107),D=function(e){var t=e.urls,n=e.onDelete,r=e.onCancel;return a.a.createElement(x.a,{striped:!0,bordered:!0,hover:!0,responsive:!0},a.a.createElement("thead",null,a.a.createElement("tr",null,["#","Long Url","Short Url","Date","Action"].map((function(e,t){return a.a.createElement("th",{key:t},e)})))),a.a.createElement("tbody",null,t.length?t.map((function(t,s){return a.a.createElement("tr",{key:t._id},a.a.createElement("td",null,s),a.a.createElement("td",null,a.a.createElement("a",{href:t.longUrl},((l=t.longUrl).length>50&&(l=l.slice(0,50)+"..."),l))),a.a.createElement("td",null,a.a.createElement("a",{href:t.shortUrl},t.shortUrl)),a.a.createElement("td",null,t.date.match(/^(.*?)GMT/)[1]),a.a.createElement("td",null,(c=t._id,e.deleteUrls.includes(c)?a.a.createElement("button",{className:"btn btn-sm btn-outline-primary",onClick:function(){return r(c)}},"Cancel"):a.a.createElement("button",{className:"btn btn-sm btn-outline-danger",onClick:function(){return n(c)}},"Delete"))));var c,l})):null))},I=function(e){function t(){var e,n;Object(i.a)(this,t);for(var r=arguments.length,a=new Array(r),s=0;s<r;s++)a[s]=arguments[s];return(n=Object(m.a)(this,(e=Object(d.a)(t)).call.apply(e,[this].concat(a)))).state={urls:[],deleteUrls:[]},n.handleDelete=function(e){var t=Object(b.a)(n.state.deleteUrls);t.push(e),n.setState({deleteUrls:t})},n.handleCancel=function(e){var t=Object(b.a)(n.state.deleteUrls);t=t.filter((function(t){return t!==e})),n.setState({deleteUrls:t})},n.handleSaveClicked=Object(u.a)(o.a.mark((function e(){var t,r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.state.deleteUrls,e.next=3,y.deleteUrls(t);case 3:r=e.sent,n.setState({urls:r.urls},(function(){return v.a.success("Saved")}));case 5:case"end":return e.stop()}}),e)}))),n}return Object(h.a)(t,e),Object(p.a)(t,[{key:"componentDidMount",value:function(){var e=Object(u.a)(o.a.mark((function e(){var t;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y.getUserInfo();case 2:t=e.sent,this.setState({urls:t.urls});case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this.state,t=e.urls,n=e.deleteUrls;return a.a.createElement(a.a.Fragment,null,a.a.createElement("div",{className:"container"},a.a.createElement("div",{className:"table",style:{marginTop:"100px"}},a.a.createElement(D,{urls:t,deleteUrls:n,onDelete:this.handleDelete,onCancel:this.handleCancel}),a.a.createElement("button",{className:"btn btn-primary",onClick:this.handleSaveClicked,disabled:!n.length},"Save"))))}}]),t}(r.Component),J=n(14),L=n(109),P=n(108),T=n(34),q=function(e){var t=e.onSigninSuccess,n=e.onSigninFail,r=e.onSignout,s=e.user;return a.a.createElement(L.a,{bg:"light",variant:"light",expand:"lg",fixed:"top"},a.a.createElement(L.a.Brand,{as:J.b,to:"/"},"Short URL"),a.a.createElement(L.a.Toggle,{"aria-controls":"basic-navbar-nav"}),a.a.createElement(L.a.Collapse,{id:"basic-navbar-nav"},a.a.createElement(P.a,{className:"mr-auto justify-content-end",style:{width:"100%"}},a.a.createElement(P.a.Link,{as:J.b,to:"/"},"Home"),s?a.a.createElement(T.GoogleLogout,{render:function(e){return a.a.createElement(P.a.Link,{onClick:e.onClick,disabled:e.disabled},"Sign Out")},buttonText:"Sign Out",clientId:"174667790191-1nbqlhhc9q996tp888v3p33q6qemgkib.apps.googleusercontent.com",onLogoutSuccess:r}):a.a.createElement(T.GoogleLogin,{render:function(e){return a.a.createElement(P.a.Link,{onClick:e.onClick,disabled:e.disabled},a.a.createElement("i",{class:"fa fa-google","aria-hidden":"true",style:{marginRight:"3px"}}),"Sign In")},clientId:"174667790191-1nbqlhhc9q996tp888v3p33q6qemgkib.apps.googleusercontent.com",buttonText:"Sign In",onSuccess:t,onFailure:n,cookiePolicy:"single_host_origin"}),s&&a.a.createElement(P.a.Link,{as:J.b,to:"/me"},s.name))))},F=n(58),H=n(37),M=n.n(H),V={signinUser:function(){var e=Object(u.a)(o.a.mark((function e(t){var n,r,a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O.post("http://api.urls.banvuong.com/api/signin",{accessToken:t});case 2:return n=e.sent,r=n.data,a=M()(r),localStorage.setItem("jwt",r),O.setJwt(r),e.abrupt("return",a);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),signoutUser:function(){localStorage.removeItem("jwt"),O.setJwt(null)},getCurrentUser:function(){var e=localStorage.getItem("jwt");return O.setJwt(e),e?M()(e):null}},_=function(e){var t=e.path,n=e.component,r=Object(F.a)(e,["path","component"]),s=V.getCurrentUser();return a.a.createElement(f.b,Object.assign({path:t},r,{render:function(e){return s?a.a.createElement(n,e):(alert("Unauthorize! Please Sign In"),a.a.createElement(f.a,{to:"/"}))}}))};n(101);v.a.configure({autoClose:1500});var A=function(e){function t(){var e,n;Object(i.a)(this,t);for(var r=arguments.length,a=new Array(r),s=0;s<r;s++)a[s]=arguments[s];return(n=Object(m.a)(this,(e=Object(d.a)(t)).call.apply(e,[this].concat(a)))).state={currentUser:null},n.handleSigninSuccess=function(){var e=Object(u.a)(o.a.mark((function e(t){var r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,V.signinUser(t.Zi.access_token);case 2:r=e.sent,n.setState({currentUser:r});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.handleSigninFail=function(){var e=Object(u.a)(o.a.mark((function e(t){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.error,console.log(n),e.abrupt("return",alert("Please allow pop up for this page. Clear Cache History if cannot log in"));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.handleSignout=function(){V.signoutUser(),window.location="/"},n}return Object(h.a)(t,e),Object(p.a)(t,[{key:"componentDidMount",value:function(){var e=V.getCurrentUser();this.setState({currentUser:e})}},{key:"render",value:function(){var e=this.state.currentUser;return a.a.createElement(a.a.Fragment,null,a.a.createElement(q,{user:e,onSigninSuccess:this.handleSigninSuccess,onSigninFail:this.handleSigninFail,onSignout:this.handleSignout}),a.a.createElement(f.d,null,a.a.createElement(_,{path:"/me",component:I}),a.a.createElement(f.b,{path:"/",render:function(t){return a.a.createElement(N,Object.assign({},t,{user:e}))}})))}}]),t}(r.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));n(102),n(103),n(104);c.a.render(a.a.createElement(J.a,null,a.a.createElement(A,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},60:function(e,t,n){e.exports=n(105)},65:function(e,t,n){}},[[60,1,2]]]);
//# sourceMappingURL=main.06574c80.chunk.js.map